{% extends "base.html" %}

{% block title %}HomeFinder - Statistiche{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <h1>Statistiche Immobili</h1>
        <p class="text-muted">Analisi dei dati raccolti</p>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title">Totale Immobili</h5>
                <p class="card-text display-4">{{ total_properties }}</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title">In Vendita</h5>
                <p class="card-text display-4 text-success">{{ vendita_properties }}</p>
                <p class="card-text">({{ "%.1f"|format((vendita_properties / total_properties * 100) if total_properties > 0 else 0) }}%)</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card text-center">
            <div class="card-body">
                <h5 class="card-title">In Affitto</h5>
                <p class="card-text display-4 text-primary">{{ affitto_properties }}</p>
                <p class="card-text">({{ "%.1f"|format((affitto_properties / total_properties * 100) if total_properties > 0 else 0) }}%)</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Statistiche Prezzi</h5>
                {% if price_stats %}
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <strong>Prezzo Minimo:</strong> € {{ "{:,}".format(price_stats.min) }}
                    </li>
                    <li class="list-group-item">
                        <strong>Prezzo Massimo:</strong> € {{ "{:,}".format(price_stats.max) }}
                    </li>
                    <li class="list-group-item">
                        <strong>Prezzo Medio:</strong> € {{ "{:,}".format(price_stats.avg) }}
                    </li>
                </ul>
                {% else %}
                <p class="text-muted">Nessun dato sui prezzi disponibile</p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Statistiche Dimensione</h5>
                {% if size_stats %}
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <strong>Dimensione Minima:</strong> {{ size_stats.min }} m²
                    </li>
                    <li class="list-group-item">
                        <strong>Dimensione Massima:</strong> {{ size_stats.max }} m²
                    </li>
                    <li class="list-group-item">
                        <strong>Dimensione Media:</strong> {{ size_stats.avg }} m²
                    </li>
                </ul>
                {% else %}
                <p class="text-muted">Nessun dato sulle dimensioni disponibile</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <h5 class="card-title">Distribuzione per Contratto</h5>
        <div class="progress mb-3">
            <div class="progress-bar bg-success" role="progressbar" 
                 style="width: {{ (vendita_properties / total_properties * 100) if total_properties > 0 else 0 }}%" 
                 aria-valuenow="{{ vendita_properties }}" 
                 aria-valuemin="0" 
                 aria-valuemax="{{ total_properties }}">
                Vendita ({{ vendita_properties }})
            </div>
            <div class="progress-bar bg-primary" role="progressbar" 
                 style="width: {{ (affitto_properties / total_properties * 100) if total_properties > 0 else 0 }}%" 
                 aria-valuenow="{{ affitto_properties }}" 
                 aria-valuemin="0" 
                 aria-valuemax="{{ total_properties }}">
                Affitto ({{ affitto_properties }})
            </div>
        </div>
    </div>
</div>
{% endblock %}